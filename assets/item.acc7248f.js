import{n as v,j as u,e as d,p,_ as r}from"./index.fd5955cd.js";var _=function(){var a,n,s=this,e=s.$createElement,t=s._self._c||e;return t("sm-loading",{attrs:{loading:s.loading,title:"\u52A0\u8F7D\u4E2D",center:""}},[s.spu?t("div",{staticClass:"wrapper"},[t("sm-box",[t("div",{staticClass:"item-wrapper"},[t("div",{staticClass:"image-wrapper"},[t("div",{staticClass:"thumbs-wrapper"},s._l(s.sku.images,function(i,l){return t("img",{key:l,class:{active:s.imgIndex===l},attrs:{src:i},on:{mouseenter:function(o){s.imgIndex=l}}})}),0),t("div",{staticClass:"gallery-wrapper"},[t("img",{attrs:{src:s.sku.images[s.imgIndex]}})])]),t("div",{staticClass:"detail-wrapper"},[t("div",{staticClass:"info"},[t("div",[t("p",{staticClass:"title"},[s._v(s._s(s.spu.title))]),t("p",{staticClass:"desc"},[s._v(s._s(s.spu.desc))])]),t("div",{staticClass:"prices"},[t("p",{staticClass:"price"},[t("i",[s._v("\xA5")]),s._v(s._s(s.sku.price.toFixed(2)))]),s.sku.cost!==s.sku.price?t("p",{staticClass:"cost"},[s._v("\u539F\u4EF7\uFF1A\xA5"+s._s(s.sku.cost.toFixed(2)))]):s._e()])]),t("ul",{staticClass:"specs"},[s._l(s.specs,function(i,l,o){return[t("li",{key:o+1e3,staticClass:"spec",class:l.includes("\u989C\u8272")?"colors":"models"},[t("p",{staticClass:"title"},[s._v(s._s(l)+"\u9009\u62E9")]),t("ul",{staticClass:"list"},s._l(i,function(c,f){return t("li",{key:f,staticClass:"item",class:[{active:c.active},{disabled:c.disabled}],on:{click:function(y){return s.clickSpecs(l,c)}}},[c.image?t("img",{staticClass:"img",attrs:{src:c.image}}):c.hex?t("div",{staticClass:"img",style:{background:c.hex}}):t("span",[s._v(s._s(c.value))])])}),0)]),t("li",{key:o+2e3,staticClass:"spec line-dashed"})]}),t("li",{staticClass:"spec quantity"},[t("p",{staticClass:"title"},[s._v("\u6570\u91CF\u9009\u62E9")]),t("ul",{staticClass:"list"},[t("li",{staticClass:"item"},[t("sm-input-number",{model:{value:s.quantity,callback:function(i){s.quantity=i},expression:"quantity"}})],1)])]),t("li",{staticClass:"spec line-solid"}),(a=s.sku)!==null&&a!==void 0&&(n=a.tips)!==null&&n!==void 0&&n.length?t("li",{staticClass:"spec tips"},[t("p",{staticClass:"title"},[s._v("\u670D\u52A1\u8BF4\u660E")]),t("ul",{staticClass:"list"},s._l(s.sku.tips,function(i,l){return t("li",{key:l,staticClass:"item"},[s._v(s._s(i))])}),0)]):s._e()],2)])])]),t("sm-box",{attrs:{title:"\u4EA7\u54C1\u4FE1\u606F"}},[t("img",{staticClass:"image-pc",attrs:{src:s.sku.image_pc},on:{load:function(i){return s.loadImage()}}})])],1):s._e(),s.spu?t("div",{staticClass:"bar-wrapper",class:{fixed:s.fixed}},[t("div",{staticClass:"container"},[t("div",{staticClass:"left"},[t("p",{staticClass:"tip"},[s._v("\u60A8\u5DF2\u9009\u62E9\uFF1A")]),t("div",{staticClass:"info"},[t("p",{staticClass:"title"},[s._v(s._s(s.spu.title)+" \xD7 "+s._s(s.quantity))]),t("ul",{staticClass:"specs"},s._l(s.selSpecs,function(i,l){return t("li",{key:l,staticClass:"spec"},[s._v(s._s(i.value))])}),0)])]),t("div",{staticClass:"right"},[t("div",{staticClass:"prices"},[t("p",{staticClass:"price"},[t("i",[s._v("\xA5")]),s._v(s._s((s.sku.price*s.quantity).toFixed(2)))]),s.sku.cost!==s.sku.price?t("p",{staticClass:"cost"},[s._v("\u539F\u4EF7\uFF1A\xA5"+s._s((s.sku.cost*s.quantity).toFixed(2)))]):s._e()]),t("sm-button",{attrs:{id:"\u{1F6D2}",width:120,height:35,size:14,color:"gray"},on:{click:s.addToCart}},[s._v("\u52A0\u5165\u8D2D\u7269\u8F66")]),t("sm-button",{attrs:{width:120,height:35,size:14},on:{click:s.gotoCheckout}},[s._v("\u7ACB\u5373\u8D2D\u4E70")])],1)])]):s._e(),s._l(s.aniCount,function(i){return t("transition",{key:i,attrs:{appear:""},on:{"before-enter":s.beforeEnter,"after-enter":s.afterEnter}},[s.animation?t("div",{staticClass:"animation",style:{top:`${s.aniEndTop}px`,left:`${s.aniEndLeft}px`}},[t("img",{attrs:{src:s.aniImg}})]):s._e()])})],2)},C=[];const k={name:"Item",data(){return{spu:null,sku:null,imgIndex:0,quantity:1,specs:null,selSpecs:[],loading:!0,fixed:!0,el:null,offsetTop:0,animation:!1,aniImg:"",aniStartTop:0,aniStartLeft:0,aniEndTop:0,aniEndLeft:0,aniCount:1}},mounted(){var n,s;this.$route.params.id.includes(u.spu.id)&&(this.spu=u.spu),this.$route.params.id.includes(d.spu.id)&&(this.spu=d.spu),this.$route.params.id.includes(p.spu.id)&&(this.spu=p.spu),this.sku=this.spu.skus.find(e=>e.id===this.$route.params.id);const a={};(s=(n=this.spu)==null?void 0:n.specs)==null||s.forEach(e=>{a[e.key]||(a[e.key]=[]),a[e.key].push({skus:e==null?void 0:e.skus,value:e==null?void 0:e.value,image:e==null?void 0:e.image,hex:e==null?void 0:e.hex,disabled:e.disabled||!1,active:e.active||!1})}),this.specs=a},methods:{loadImage(){this.loading=!1,this.$nextTick(()=>{this.el=document.documentElement,this.offsetTop=document.querySelector(".sm-footer").offsetTop,this.offsetTop+=document.querySelector(".bar-wrapper").clientHeight,window.addEventListener("scroll",this.handleScroll),this.handleScroll()}),r.keys(this.specs).forEach(n=>{const s=this.specs[n].find(e=>e.skus.includes(this.sku.id));s&&this.clickSpecs(n,s)})},clickSpecs(a,n){const s=r.keys(this.specs);s.forEach(t=>{const i=this.specs[t].find(l=>l.value===n.value);!i||(i&&(i.active=!i.active),i.active?this.selSpecs.push(i):this.selSpecs=this.selSpecs.filter(l=>i.key!==l.key||i.value!==l.value))});let e=this.selSpecs.map(t=>t.skus);e=r.intersection(...e),s.forEach(t=>{this.specs[t].forEach(i=>{if(i.disabled=!1,!e.length)return;r.intersection(i.skus,e).length||(i.disabled=!0)})}),e.length&&!e.includes(this.sku.id)&&(this.sku=this.spu.skus.find(t=>t.id===r.head(e)))},handleScroll(){this.fixed=this.el.clientHeight+this.el.scrollTop<=this.offsetTop},gotoCheckout(){this.$router.push({name:"Checkout",params:{products:[{sku:this.sku,quantity:this.quantity}]}})},addToCart(){this.$store.dispatch("cart/addToCart",{sku:this.sku,quantity:this.quantity});const a=document.querySelector("#\u{1F6D2}").getBoundingClientRect();this.aniStartTop=a.top-a.height,this.aniStartLeft=a.left+a.width/2;const n=document.querySelector(".header-cart").getBoundingClientRect();this.aniEndTop=n.top,this.aniEndLeft=n.left,this.animation=!0,this.aniImg=this.sku.image,this.aniCount++},beforeEnter(a){const n=a.style,e=a.children[0].style;n.transform=`translate3d(0, ${this.aniStartTop-this.aniEndTop}px, 0)`,e.transform=`translate3d(${-(this.aniEndLeft-this.aniStartLeft)}px, 0, 0) scale(2)`},afterEnter(a){const n=a.style,s=a.children[0],e=s.style;n.transform="translate3d(0, 0, 0)",e.transform="translate3d(0, 0, 0) scale(0)",n.transition="transform .6s cubic-bezier(0.3, 0.55, 0.5, 1.1)",e.transition="transform .6s linear",s.addEventListener("transitionend",()=>{this.animation=!1}),s.addEventListener("webkitAnimationEnd",()=>{this.animation=!1})}}},h={};var m=v(k,_,C,!1,g,"d6a71b7c",null,null);function g(a){for(let n in h)this[n]=h[n]}const S=function(){return m.exports}();export{S as default};
